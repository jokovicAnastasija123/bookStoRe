window.onload=function(){function t(t,e){$.ajax({url:"assets/data/"+t+".json",method:"get",dataType:"json",success:e,error:function(t){console.log(t)}})}function e(t,e){localStorage.setItem(t,JSON.stringify(e))}function n(t){return JSON.parse(localStorage.getItem(t))}t("navigation",t=>{!function(t){let e="";for(let n of t)e+=`<li class="nav-item text-right">\n                        <a class="nav-link" href="${n.href}">${n.linkName}</a>\n                     </li>`;e+='<li class="nav-item cartIcon text-right"><a class="nav-link" href="cart.html"><i class="fa fa-shopping-cart" aria-hidden="true"></i></a><span class="productsInCart"></span></li>',$("#navigation").append(e),l()}(t)}),t("socialMediasFooter",t=>{!function(t){let e="";for(let n of t)e+=`<li><a href="${n.href}" target="blank">${n.icon}</a></li>`;$(".social").html(e)}(t)}),t("authors",function(t){e("authors",t),function(t){let e="";for(let n of t)e+=`<li class="form-group col-6 col-lg-12">\n            <input type="checkbox" name="${n.name}" class="author" value="${n.id}"> ${n.name}\n          </li>`;e+="<hr/>",$("#filterAuthors").append(e)}(t)}),t("publishers",t=>{e("publishers",t),function(t){let e="";for(let n of t)e+=`<li class="form-group col-6 col-lg-12">\n            <input type="checkbox" name="${n.name}" class="publisher" value="${n.id}"> ${n.name}\n          </li>`;e+="<hr/>",$("#filterPublishers").append(e)}(t)}),t("categories",t=>{e("categories",t),function(t){let e="";for(let n of t)e+=`<li class="form-group col-6 col-lg-12">\n            <input type="checkbox" name="${n.name}" class="category" value="${n.id}"> ${n.name}\n          </li>`;e+="<hr/>",$("#filterCategories").append(e)}(t)}),t("books",t=>{e("books",t),function(t){let e=g(t=t.filter(t=>{if(t.new)return t}));$("#newBooks").append(e)}(t),function(t){let e=g(t=k(t));$("#specialOffers").html(e)}(t),f(t)});var a=n("authors"),s=n("publishers"),r=n("categories"),o=n("books");function l(){let t;localStorage&&((t=n("numberOfProductsInCart"))?$(".productsInCart").html(t):$(".productsInCart").html("0"))}function i(){$("#cartTable").html(function(t){if(null!=t&&0!=t.length){let e='<thead>\n                            <tr>\n                                <td class="cart-product text-center">product</td>\n                                <td class="cart-price text-center" >price</td>\n                                <td class="cart-quantity text-center">quantity</td>\n                                <td class="cart-total text-center">total</td>\n                                <td class="cart-remove text-center">remove</td>\n                            </tr>\n                        </thead>\n                        <tbody>';for(let n of t)e+=`<tr data-book='${n.id}'>\n                        <td>\n                            <div class='row'>\n                                <div class='col-lg-6 col-12 text-center'>${p(n.id)}</div>\n                                <div class='col-lg-6 col-12 text-lg-left text-center mt-3'>${n.name} <p>by: ${d(n.id)}</p></div>\n                            </div> \n                        </td>\n                <td class="cart-price text-center">$${u(n.id)}</td>\n                <td class="cart-quantity row pt-3 mt-5 mt-lg-1">\n                 <div class='col-6 text-right mt-3'>${n.quantity}</div>\n                  <div class='cartQuantity col-6 text-left'>\n                  <button class=" qty-plus ml-1">+</button> <button class="ml-1 qty-minus">-</button>\n                  </div>\n                </td>\n                <td class="cart-total text-center">$${c(u(n.id),n.quantity)}</td>\n                <td class="cart-remove text-center"><button class="remove">remove</button></td>\n            </tr>`;return e+=`<tr><td colspan='5'><p class='text-right mt-3'><span class='font-weight-bold'> Total: </span>$${function(t){let e=0;for(let n of t)e+=parseFloat(c(u(n.id),n.quantity));return e.toFixed(2)}(t)}</p>\n            <p class='text-right'><button class="text-uppercase btnBuy">buy</button></p></td></tr></tbody>`}return"<h3>Your cart is empty</h3>\n                    <button class='btnCartShopping mt-5'>Continue shopping</button>"}(n("products"))),$("#cartTable tbody tr:even").addClass("tableZebra")}function c(t,e){return(t*e).toFixed(2)}function u(t){for(let e of o)if(e.id==t)return e.price.new}function d(t){for(let e of o)if(e.id==t)return v(e.author)}function p(t){for(let e of o)if(e.id==t)return`<img src="${e.thumbnail.src}" alt="${e.thumbnail.alt}" class='img-fluid'>`}function f(t){t=h(".author",t=function(t){let e=$("#price").val(),n=$("#title").val();0!=e&&(t="asc"==e?t.sort(function(t,e){return t.price.new>e.price.new?1:t.price.new<e.price.new?-1:0}):t.sort(function(t,e){return t.price.new>e.price.new?-1:t.price.new<e.price.new?1:0}));0!=n&&(t="az"==n?t.sort(function(t,e){return t.name.toUpperCase()>e.name.toUpperCase()?1:t.name.toUpperCase()<e.name.toUpperCase()?-1:0}):t.sort(function(t,e){return t.name.toUpperCase()>e.name.toUpperCase()?-1:t.name.toUpperCase()<e.name.toUpperCase()?1:0}));return t}(t)),t=h(".category",t);let e=g(t=function(t){$(".spOffers").is(":checked")&&(t=k(t));return t}(t=function(t){let e=$(".search").val(),n=window.location.href,a=n.substr(n.lastIndexOf("/")+1,n.length);""!=e&&"products.html"==a&&(t=t.filter(function(t){if(t.name.toUpperCase().includes(e.toUpperCase()))return t}));return t}(t=h(".publisher",t))));$("html, body").animate({scrollTop:0},800),$("#products").html(e)}function m(){f(o)}function h(t,e){let n=[];for(let e of document.querySelectorAll(t))e.checked&&n.push(parseInt(e.value));return 0!=n.length&&(e=e.filter(function(e){for(let a of n)if(".author"==t){if(e.author==a)return e}else if(".category"==t){if(e.category==a)return e}else if(".publisher"==t&&e.publisher==a)return e})),e}function g(t){if(0==t.length)return'<h4 class="m-auto">Sorry, no results...</h4>';{let e="";for(let n of t)e+=`<div class="book text-center col-lg-3 col-md-4 col-sm-6 col-12 ">\n                <div class="bookImage mb-2">\n                ${b(n.specialOffer)}\n                    <a href="#" data-target="${n.id}" class="bookImageLink">\n                        <img src="${n.thumbnail.src}" alt="${n.thumbnail.alt}">\n                    </a>\n                </div>\n                <div class="bookTitle">\n                    <h3>${n.name}</h3>\n                </div>\n                <p class="bookAuthor">by ${v(n.author)}</p>\n                <p class="bookCategory">${y(n.category)}</p>\n                <div class="bookPrice">\n                    ${C(n.price)}\n                </div>\n                <p class="freeShipping">\n                   ${w(n.freeShipping)}\n                </p>\n                <button class="addToCartBooks mt-auto" data-cart="${n.id}">add to cart</button>\n            </div>`;return e}}function b(t){return t?'<p class="specialOffer text-center">special</br>offer</p>':""}function v(t){for(let e of a)if(t==e.id)return e.name}function y(t){for(let e of r)if(t==e.id)return e.name}function C(t){return t.old?`<span>$${t.new}</span>\n        <del  class="ml-1">$${t.old}</del>`:`<span>$${t.new}</span>`}function w(t){return t?' <i class="fa fa-truck mr-2" aria-hidden="true"></i>Free shipping':""}function k(t){return t=t.filter(function(t){if(t.specialOffer)return t})}function x(t){for(let e of s)if(t==e.id)return e.name}function I(t){return t?'<p><i class="fa fa-truck mr-2" aria-hidden="true"></i>Free shipping</p>':""}function P(t){return t.old?`<del class="oldPrice">$${t.old}</del>\n         <p>Current price: <span class="currentPrice">$${t.new}</span></p>`:`<p><span class="currentPrice">$${t.new}</span><p>`}function O(t){return t?'<p class="specialOfferSingleProduct text-center">special</br>offer</p>':""}function T(t,e,n){e.test(t.val())?n.hasClass("displayNone")||n.addClass("displayNone"):n.hasClass("displayNone")&&n.removeClass("displayNone")}function S(t,e,n){return e.test(t.val())?(n.hasClass("displayNone")||n.addClass("displayNone"),!0):(n.hasClass("displayNone")&&n.removeClass("displayNone"),!1)}$(".search").keyup(m),$("#sort").change(m),$("#filterAuthors").change(m),$("#filterCategories").change(m),$("#filterPublishers").change(m),$("#filterSpecialOffers").change(m),$(document).on("click",".bookImage",t=>{t.preventDefault(),stop(!0,!0),function(t){let e=o.filter(function(e){if(t==e.id)return e}),n="";for(let t of e)n+=`<div class="container m-auto row singleProductContent pt-5">\n             <div class="col-sm-5 spimage text-center">\n               <img src="${t.image.src}" alt="${t.image.alt}" class='img-fluid' >\n               ${O(t.specialOffer)}\n             </div>\n             <div class="col-md-6 col-10 text-left">\n               <h3 class="mb-3">${t.name}</h3>\n               <p>${y(t.category)}</p>\n               <div class="authorPublisher mt-2 mb-3">\n                 <span>Author: ${v(t.author)}</span><br>\n                 <span>Publisher: ${x(t.publisher)}</span>\n               </div>\n               <p>${t.description}</p>\n               ${P(t.price)}\n               <button class="addToCart mb-2" data-cart='${t.id}'>Add to cart</button>\n               ${I(t.freeShipping)}\n             </div>\n             <div class="col-1 text-right">\n               <button class="close" id="btnClose">\n                 <i class="fa fa-times " aria-hidden="true"></i>\n                 </button>\n             </div>\n           </div>`;$(".singleProduct").html(n),$("body").addClass("overflow"),$(".singleProduct").addClass("show").animate({opacity:"1"},500),$("#btnClose").click(t=>{t.preventDefault(),stop(!0,!0),$(".singleProduct").animate({opacity:"0"},500,function(){$(".singleProduct").removeClass("show")}),$("body").removeClass("overflow")})}(t.target.parentElement.dataset.target)}),$(document).on("click",".addToCartBooks, .addToCart",t=>{t.preventDefault(),stop(!0,!0);let a=t.target.dataset.cart;!function(){let t;localStorage&&(e("numberOfProductsInCart",(t=n("numberOfProductsInCart"))?t+1:1),l())}(),function(t){let a,s=n("products");for(let e of o)t==e.id&&(a={id:e.id,name:e.name,quantity:1});if(localStorage)if(null!=s){let t,n=[];for(let t of s)n.push(t.id);if(n.includes(a.id)){for(let t of s)t.id==a.id&&(t.quantity+=1);t=!1}else t=!0;t&&s.push(a),e("products",s)}else e("products",[a])}(a),function(t){let e=o.filter(function(e){if(t==e.id)return e}),n="";for(let t of e)n+=`<div class=" modalCart text-center text-lg-left">\n            <h6>The book has been added to cart</h6>\n            <div class="row">\n                <div class="col-lg-4">\n                    <img src="${t.thumbnail.src}" alt="${t.thumbnail.alt}" class="img-fluid">\n                </div>\n                <div class="col-lg-8">\n                    <p>${t.name}</p>\n                    <p>${v(t.author)}</p>\n                    <p>$${t.price.new}</p>\n                <button class="goToCart mb-3">Go to cart</button>\n                <button class="backToSopping">Continue shopping</button>\n                </div>\n            </div>\n        </div>`;$(".modal").html(n),$("body").addClass("overflow"),$(".modal").addClass("show").animate({opacity:"1"},300),$(".backToSopping").click(t=>{t.preventDefault(),stop(!0,!0),$(".modal").animate({opacity:"0"},500,function(){$(".modal").removeClass("show")}),$(".singleProduct").hasClass("show")||$("body").removeClass("overflow")}),$(".goToCart").click(t=>{t.preventDefault(),stop(!0,!0);let e=window.location.href,n=e.substr(0,e.lastIndexOf("/")+1)+"cart.html";window.location.href=n})}(a)}),$(document).on("click",".qty-plus",t=>{let a=parseInt(t.target.parentElement.parentElement.parentElement.dataset.book),s=n("products"),r=n("numberOfProductsInCart");for(let t of s)a==t.id&&t.quantity<20&&(t.quantity+=1,r+=1);e("numberOfProductsInCart",r),l(),e("products",s),i()}),$(document).on("click",".qty-minus",t=>{let a=parseInt(t.target.parentElement.parentElement.parentElement.dataset.book),s=n("products"),r=n("numberOfProductsInCart");for(let t of s)a==t.id&&t.quantity>1&&(t.quantity-=1,r-=1);e("numberOfProductsInCart",r),l(),e("products",s),i()}),$(document).on("click",".remove",t=>{let a=parseInt(t.target.parentElement.parentElement.dataset.book),s=n("products"),r=n("numberOfProductsInCart");for(let t of s)t.id==a&&(r-=t.quantity,s.splice(s.indexOf(t),1));e("numberOfProductsInCart",r),l(),e("products",s),i()}),$(document).on("click",".btnCartShopping",t=>{t.preventDefault(),stop(!0,!0),window.location.href="products.html"}),i(),$(window).scroll(function(){$(this).scrollTop()>200?$("#scrollToTop").fadeIn():$("#scrollToTop").fadeOut()}),$("#scrollToTop").click(function(){$("html").animate({scrollTop:0},800)}),$("#contactSubmit").hover(function(){$(this).css("background","rgb(231, 231, 231)")},function(){$(this).css("background","#fff")}),$("#name").keyup(()=>{$(".sentMessage").hasClass("displayNone")||$(".sentMessage").addClass("displayNone");T($("#name"),/^[A-Z][a-z]{2,15}(\s[A-Z][a-z]{2,25})+$/,$(".nameError"))}),$("#email").keyup(()=>{$(".sentMessage").hasClass("displayNone")||$(".sentMessage").addClass("displayNone");T($("#email"),/^\w+(\.\w+)*\@[a-z]+(\.[a-z]+)*(\.[a-z]{2,3})$/,$(".emailError"))}),$("#message").keyup(()=>{$(".sentMessage").hasClass("displayNone")||$(".sentMessage").addClass("displayNone");T($("#message"),/^[A-Z][\w\.\,\?\!\-\;\:\'\"]{5,30}(\s[\w\.\,\?\!\-\;\:\'\"]{1,20})*$/,$(".messageError"))}),$("#contactSubmit").click(()=>{$(".sentMessage").hasClass("displayNone")||$(".sentMessage").addClass("displayNone");let t=$("#name"),e=$("#email"),n=$("#message"),a=$(".nameError"),s=$(".emailError"),r=$(".messageError");return!!S(t,/^[A-Z][a-z]{2,15}(\s[A-Z][a-z]{2,25})+$/,a)&&(!!S(e,/^\w+(\.\w+)*\@[a-z]+(\.[a-z]+)*(\.[a-z]{2,3})$/,s)&&(!!S(n,/^[A-Z][\w\.\,\?\!\-\;\:\'\"]{5,30}(\s[\w\.\,\?\!\-\;\:\'\"]{1,20})*$/,r)&&($("#name").val(""),$("#email").val(""),$("#message").val(""),$(".sentMessage").removeClass("displayNone"),!0)))}),$(".btnFilters").click(function(){"block"==$(".filter").css("display")?($(this).html('Show filters <i class="fa fa-sliders" aria-hidden="true"></i>'),$(".filter").hide("slow"),$(".btnFilters > .fa-times").css("display","none")):($(this).html('Hide filters <i class="fa fa-sliders" aria-hidden="true"></i>'),$(".filter").show("slow"),$(".btnFilters > .fa-times").css("display","block"))})};